!function n(o,i,s){function a(e,r){if(!i[e]){if(!o[e]){var t="function"==typeof require&&require;if(!r&&t)return t(e,!0);if(c)return c(e,!0);throw(r=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",r}t=i[e]={exports:{}},o[e][0].call(t.exports,function(r){return a(o[e][1][r]||r)},t,t.exports,n,o,i,s)}return i[e].exports}for(var c="function"==typeof require&&require,r=0;r<s.length;r++)a(s[r]);return a}({1:[function(r,e,t){var n,o,e=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}try{n="function"==typeof setTimeout?setTimeout:i}catch(r){n=i}try{o="function"==typeof clearTimeout?clearTimeout:s}catch(r){o=s}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return(n=setTimeout)(e,0);try{return n(e,0)}catch(r){try{return n.call(null,e,0)}catch(r){return n.call(this,e,0)}}}var c,u=[],l=!1,h=-1;function p(){l&&c&&(l=!1,c.length?u=c.concat(u):h=-1,u.length&&f())}function f(){if(!l){for(var r=a(p),e=(l=!0,u.length);e;){for(c=u,u=[];++h<e;)c&&c[h].run();h=-1,e=u.length}c=null,l=!1,!function(e){if(o===clearTimeout)return clearTimeout(e);if((o===s||!o)&&clearTimeout)return(o=clearTimeout)(e);try{o(e)}catch(r){try{return o.call(null,e)}catch(r){return o.call(this,e)}}}(r)}}function _(r,e){this.fun=r,this.array=e}function d(){}e.nextTick=function(r){var e=new Array(arguments.length-1);if(1<arguments.length)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];u.push(new _(r,e)),1!==u.length||l||a(f)},_.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=d,e.addListener=d,e.once=d,e.off=d,e.removeListener=d,e.removeAllListeners=d,e.emit=d,e.prependListener=d,e.prependOnceListener=d,e.listeners=function(r){return[]},e.binding=function(r){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(r){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},{}],2:[function(r,e,t){"use strict";r=r("./wampy.js");window.Wampy=r.Wampy},{"./wampy.js":7}],3:[function(r,e,n){!function(t){!function(){"use strict";function e(r){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}Object.defineProperty(n,"__esModule",{value:!0}),n.isNode=n.WAMP_MSG_SPEC=n.WAMP_ERROR_MSG=n.SUCCESS=n.E2EE_SERIALIZERS=void 0;n.WAMP_MSG_SPEC={HELLO:1,WELCOME:2,ABORT:3,CHALLENGE:4,AUTHENTICATE:5,GOODBYE:6,ERROR:8,PUBLISH:16,PUBLISHED:17,SUBSCRIBE:32,SUBSCRIBED:33,UNSUBSCRIBE:34,UNSUBSCRIBED:35,EVENT:36,CALL:48,CANCEL:49,RESULT:50,REGISTER:64,REGISTERED:65,UNREGISTER:66,UNREGISTERED:67,INVOCATION:68,INTERRUPT:69,YIELD:70},n.SUCCESS={code:0,error:null},n.WAMP_ERROR_MSG={SUCCESS:"Success!",URI_ERROR:"Topic URI doesn't meet requirements!",NO_BROKER:"Server doesn't provide broker role!",NO_CALLBACK_SPEC:"No required callback function specified!",INVALID_PARAM:"Invalid parameter(s) specified!",NO_SERIALIZER_AVAILABLE:"Server has chosen a serializer, which is not available!",NON_EXIST_UNSUBSCRIBE:"Trying to unsubscribe from non existent subscription!",NO_DEALER:"Server doesn't provide dealer role!",RPC_ALREADY_REGISTERED:"RPC already registered!",NON_EXIST_RPC_UNREG:"Received rpc unregistration for non existent rpc!",NON_EXIST_RPC_INVOCATION:"Received invocation for non existent rpc!",NON_EXIST_RPC_REQ_ID:"No RPC calls in action with specified request ID!",NO_REALM:"No realm specified!",NO_WS_OR_URL:"No websocket provided or URL specified is incorrect!",NO_CRA_CB_OR_ID:"No onChallenge callback or authid was provided for authentication!",CHALLENGE_EXCEPTION:"Exception raised during challenge processing",PPT_NOT_SUPPORTED:"Payload Passthru Mode is not supported by the router",PPT_INVALID_SCHEME:"Provided PPT scheme is invalid",PPT_SRLZ_INVALID:"Provided PPT serializer is invalid or not supported",PPT_SRLZ_ERR:"Can not serialize/deserialize payload",PROTOCOL_VIOLATION:"Protocol violation",WAMP_ABORT:"Router aborted connection",WAMP_GENERAL_ERROR:"Wamp error",WEBSOCKET_ERROR:"Websocket error",FEATURE_NOT_SUPPORTED:"Feature not supported"};n.E2EE_SERIALIZERS=["cbor"];var r="object"===(void 0===t?"undefined":e(t))&&"[object process]"===Object.prototype.toString.call(t);n.isNode=r}.call(this)}.call(this,r("_process"))},{_process:1}],4:[function(r,e,t){"use strict";function o(r){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}Object.defineProperty(t,"__esModule",{value:!0}),t.WebsocketError=t.WampError=t.UriError=t.UnsubscribeError=t.UnregisterError=t.SubscribeError=t.RegisterError=t.RPCAlreadyRegisteredError=t.PublishError=t.ProtocolViolationError=t.PPTSerializerInvalidError=t.PPTSerializationError=t.PPTNotSupportedError=t.PPTInvalidSchemeError=t.NonExistUnsubscribeError=t.NonExistRPCUnregistrationError=t.NonExistRPCReqIdError=t.NoWsOrUrlError=t.NoSerializerAvailableError=t.NoRealmError=t.NoDealerError=t.NoCallbackError=t.NoCRACallbackOrIdError=t.NoBrokerError=t.InvalidParamError=t.FeatureNotSupportedError=t.ChallengeExceptionError=t.CallError=t.AbortError=void 0;var a=r("./constants.js");function n(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,function(r){r=function(r,e){if("object"!==o(r)||null===r)return r;var t=r[Symbol.toPrimitive];if(void 0===t)return("string"===e?String:Number)(r);t=t.call(r,e||"default");if("object"!==o(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}(r,"string");return"symbol"===o(r)?r:String(r)}(n.key),n)}}function c(r,e,t){return e&&n(r.prototype,e),t&&n(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function u(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function l(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&f(r,e)}function h(t){var n=s();return function(){var r,e=_(t),e=(r=n?(r=_(this).constructor,Reflect.construct(e,arguments,r)):e.apply(this,arguments),this);if(r&&("object"===o(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function p(r){var t="function"==typeof Map?new Map:void 0;return(p=function(r){if(null===r||-1===Function.toString.call(r).indexOf("[native code]"))return r;if("function"!=typeof r)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(r))return t.get(r);t.set(r,e)}function e(){return i(r,arguments,_(this).constructor)}return e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),f(e,r)})(r)}function i(r,e,t){return(i=s()?Reflect.construct.bind():function(r,e,t){var n=[null];n.push.apply(n,e);e=new(Function.bind.apply(r,n));return t&&f(e,t.prototype),e}).apply(null,arguments)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(r){return!1}}function f(r,e){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,e){return r.__proto__=e,r})(r,e)}function _(r){return(_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)})(r)}var r=function(){l(t,p(Error));var e=h(t);function t(){var r;return u(this,t),(r=e.call(this,a.WAMP_ERROR_MSG.URI_ERROR)).name="UriError",r.code=1,r}return c(t)}(),r=(t.UriError=r,function(){l(t,p(Error));var e=h(t);function t(){var r;return u(this,t),(r=e.call(this,a.WAMP_ERROR_MSG.NO_BROKER)).name="NoBrokerError",r.code=2,r}return c(t)}()),r=(t.NoBrokerError=r,function(){l(t,p(Error));var e=h(t);function t(){var r;return u(this,t),(r=e.call(this,a.WAMP_ERROR_MSG.NO_CALLBACK_SPEC)).name="NoCallbackError",r.code=3,r}return c(t)}()),r=(t.NoCallbackError=r,function(){l(n,p(Error));var t=h(n);function n(r){var e;return u(this,n),(e=t.call(this,a.WAMP_ERROR_MSG.INVALID_PARAM)).name="InvalidParamError",e.code=4,e.parameter=r,e}return c(n)}()),r=(t.InvalidParamError=r,function(){l(t,p(Error));var e=h(t);function t(){var r;return u(this,t),(r=e.call(this,a.WAMP_ERROR_MSG.NO_SERIALIZER_AVAILABLE)).name="NoSerializerAvailableError",r.code=6,r}return c(t)}()),r=(t.NoSerializerAvailableError=r,function(){l(t,p(Error));var e=h(t);function t(){var r;return u(this,t),(r=e.call(this,a.WAMP_ERROR_MSG.NON_EXIST_UNSUBSCRIBE)).name="NonExistUnsubscribeError",r.code=7,r}return c(t)}()),r=(t.NonExistUnsubscribeError=r,function(){l(t,p(Error));var e=h(t);function t(){var r;return u(this,t),(r=e.call(this,a.WAMP_ERROR_MSG.NO_DEALER)).name="NoDealerError",r.code=12,r}return c(t)}()),r=(t.NoDealerError=r,function(){l(t,p(Error));var e=h(t);function t(){var r;return u(this,t),(r=e.call(this,a.WAMP_ERROR_MSG.RPC_ALREADY_REGISTERED)).name="RPCAlreadyRegisteredError",r.code=15,r}return c(t)}()),r=(t.RPCAlreadyRegisteredError=r,function(){l(t,p(Error));var e=h(t);function t(){var r;return u(this,t),(r=e.call(this,a.WAMP_ERROR_MSG.NON_EXIST_RPC_UNREG)).name="NonExistRPCUnregistrationError",r.code=17,r}return c(t)}()),r=(t.NonExistRPCUnregistrationError=r,function(){l(t,p(Error));var e=h(t);function t(){var r;return u(this,t),(r=e.call(this,a.WAMP_ERROR_MSG.NON_EXIST_RPC_REQ_ID)).name="NonExistRPCReqIdError",r.code=20,r}return c(t)}()),r=(t.NonExistRPCReqIdError=r,function(){l(t,p(Error));var e=h(t);function t(){var r;return u(this,t),(r=e.call(this,a.WAMP_ERROR_MSG.NO_REALM)).name="NoRealmError",r.code=21,r}return c(t)}()),r=(t.NoRealmError=r,function(){l(t,p(Error));var e=h(t);function t(){var r;return u(this,t),(r=e.call(this,a.WAMP_ERROR_MSG.NO_WS_OR_URL)).name="NoWsOrUrlError",r.code=22,r}return c(t)}()),r=(t.NoWsOrUrlError=r,function(){l(t,p(Error));var e=h(t);function t(){var r;return u(this,t),(r=e.call(this,a.WAMP_ERROR_MSG.NO_CRA_CB_OR_ID)).name="NoCRACallbackOrIdError",r.code=23,r.errorUri="wamp.error.cannot_authenticate",r}return c(t)}()),r=(t.NoCRACallbackOrIdError=r,function(){l(t,p(Error));var e=h(t);function t(){var r;return u(this,t),(r=e.call(this,a.WAMP_ERROR_MSG.CHALLENGE_EXCEPTION)).name="ChallengeExceptionError",r.code=24,r.errorUri="wamp.error.cannot_authenticate",r}return c(t)}()),r=(t.ChallengeExceptionError=r,function(){l(t,p(Error));var e=h(t);function t(){var r;return u(this,t),(r=e.call(this,a.WAMP_ERROR_MSG.PPT_NOT_SUPPORTED)).name="PPTNotSupportedError",r.code=25,r}return c(t)}()),r=(t.PPTNotSupportedError=r,function(){l(t,p(Error));var e=h(t);function t(){var r;return u(this,t),(r=e.call(this,a.WAMP_ERROR_MSG.PPT_INVALID_SCHEME)).name="PPTInvalidSchemeError",r.code=26,r}return c(t)}()),r=(t.PPTInvalidSchemeError=r,function(){l(t,p(Error));var e=h(t);function t(){var r;return u(this,t),(r=e.call(this,a.WAMP_ERROR_MSG.PPT_SRLZ_INVALID)).name="PPTSerializerInvalidError",r.code=27,r}return c(t)}()),r=(t.PPTSerializerInvalidError=r,function(){l(t,p(Error));var e=h(t);function t(){var r;return u(this,t),(r=e.call(this,a.WAMP_ERROR_MSG.PPT_SRLZ_ERR)).name="PPTSerializationError",r.code=28,r}return c(t)}()),r=(t.PPTSerializationError=r,function(){l(n,p(Error));var t=h(n);function n(r,e){return u(this,n),(e=t.call(this,e||a.WAMP_ERROR_MSG.PROTOCOL_VIOLATION)).name="ProtocolViolationError",e.code=29,e.errorUri=r,e}return c(n)}()),r=(t.ProtocolViolationError=r,function(){l(o,p(Error));var n=h(o);function o(r){var e,t=r.error,r=r.details;return u(this,o),(e=n.call(this,a.WAMP_ERROR_MSG.WAMP_ABORT)).name="AbortedError",e.code=30,e.errorUri=t,e.details=r,e}return c(o)}()),d=(t.AbortError=r,function(){l(s,p(Error));var i=h(s);function s(r){var e,t=r.error,n=r.details,o=r.argsList,r=r.argsDict;return u(this,s),(e=i.call(this,a.WAMP_ERROR_MSG.WAMP_GENERAL_ERROR)).name="WampError",e.code=31,e.errorUri=t,e.details=n,e.argsList=o,e.argsDict=r,e}return c(s)}()),r=(t.WampError=d,function(){l(i,d);var o=h(i);function i(r){var e=r.error,t=r.details,n=r.argsList,r=r.argsDict;return u(this,i),(e=o.call(this,{error:e,details:t,argsList:n,argsDict:r})).name="SubscribeError",e.code=32,e}return c(i)}()),r=(t.SubscribeError=r,function(){l(i,d);var o=h(i);function i(r){var e=r.error,t=r.details,n=r.argsList,r=r.argsDict;return u(this,i),(e=o.call(this,{error:e,details:t,argsList:n,argsDict:r})).name="UnsubscribeError",e.code=33,e}return c(i)}()),r=(t.UnsubscribeError=r,function(){l(i,d);var o=h(i);function i(r){var e=r.error,t=r.details,n=r.argsList,r=r.argsDict;return u(this,i),(e=o.call(this,{error:e,details:t,argsList:n,argsDict:r})).name="PublishError",e.code=34,e}return c(i)}()),r=(t.PublishError=r,function(){l(i,d);var o=h(i);function i(r){var e=r.error,t=r.details,n=r.argsList,r=r.argsDict;return u(this,i),(e=o.call(this,{error:e,details:t,argsList:n,argsDict:r})).name="RegisterError",e.code=35,e}return c(i)}()),r=(t.RegisterError=r,function(){l(i,d);var o=h(i);function i(r){var e=r.error,t=r.details,n=r.argsList,r=r.argsDict;return u(this,i),(e=o.call(this,{error:e,details:t,argsList:n,argsDict:r})).name="UnregisterError",e.code=36,e}return c(i)}()),r=(t.UnregisterError=r,function(){l(i,d);var o=h(i);function i(r){var e=r.error,t=r.details,n=r.argsList,r=r.argsDict;return u(this,i),(e=o.call(this,{error:e,details:t,argsList:n,argsDict:r})).name="CallError",e.code=37,e}return c(i)}()),r=(t.CallError=r,function(){l(n,p(Error));var t=h(n);function n(r){var e;return u(this,n),(e=t.call(this,a.WAMP_ERROR_MSG.WEBSOCKET_ERROR)).name="WebsocketError",e.code=38,e.error=r,e}return c(n)}()),r=(t.WebsocketError=r,function(){l(o,p(Error));var n=h(o);function o(r,e){var t;return u(this,o),(t=n.call(this,a.WAMP_ERROR_MSG.FEATURE_NOT_SUPPORTED)).name="FeatureNotSupportedError",t.code=39,t.role=r,t.feature=e,t}return c(o)}());t.FeatureNotSupportedError=r},{"./constants.js":3}],5:[function(r,e,t){"use strict";function o(r){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function i(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,function(r){r=function(r,e){if("object"!==o(r)||null===r)return r;var t=r[Symbol.toPrimitive];if(void 0===t)return("string"===e?String:Number)(r);t=t.call(r,e||"default");if("object"!==o(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}(r,"string");return"symbol"===o(r)?r:String(r)}(n.key),n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.JsonSerializer=void 0;var n=function(){function r(){if(!(this instanceof r))throw new TypeError("Cannot call a class as a function");this.protocol="json",this.isBinary=!1}var e,t,n;return e=r,(t=[{key:"encode",value:function(r){return JSON.stringify(r)}},{key:"decode",value:function(r){return JSON.parse(r)}}])&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),r}();t.JsonSerializer=n},{}],6:[function(r,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewPromise=function(){var t={};return t.promise=new Promise(function(r,e){t.onSuccess=r,t.onError=e}),t},t.getWebSocket=function(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=r.url,t=r.protocols,n=r.options,r=r.isBrowserMock,n=n||{},o=n.ws,i=n.additionalHeaders,n=n.wsRequestOptions,r=s.isNode&&!r;if(!o&&r)return null;r=(r?function(r){return a(r)?r:null}:function(r){if(a(r))return r;var e="https:"===window.location.protocol?"wss://":"ws://",t=window.location.port?":".concat(window.location.port):"";if(!r)return"".concat(e).concat(window.location.hostname).concat(t,"/ws");if(r.startsWith("/"))return"".concat(e).concat(window.location.hostname).concat(t).concat(r);return"".concat(e).concat(r)})(e);if(!r)return null;if(o)return new o(r,t,null,i,n);return function(r,e){var t;{if(null!=(t=window)&&t.WebSocket)return new window.WebSocket(r,e);if(null!=(t=window)&&t.MozWebSocket)return new window.MozWebSocket(r,e)}return null}(r,t)};var s=r("./constants.js");function a(r){return/^ws(s)?:\/\//.test(r)}},{"./constants.js":3}],7:[function(r,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Wampy=t.Errors=void 0;var O=r("./constants.js"),k=function(r,e){if(!e&&r&&r.__esModule)return r;if(null===r||"object"!==A(r)&&"function"!=typeof r)return{default:r};e=s(e);if(e&&e.has(r))return e.get(r);var t,n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(t in r){var i;"default"!==t&&Object.prototype.hasOwnProperty.call(r,t)&&((i=o?Object.getOwnPropertyDescriptor(r,t):null)&&(i.get||i.set)?Object.defineProperty(n,t,i):n[t]=r[t])}n.default=r,e&&e.set(r,n);return n}(r("./errors.js")),C=(t.Errors=k,r("./utils.js")),M=r("./serializers/JsonSerializer.js");function s(r){var e,t;return"function"!=typeof WeakMap?null:(e=new WeakMap,t=new WeakMap,(s=function(r){return r?t:e})(r))}function A(r){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function I(r){return function(r){if(Array.isArray(r))return n(r)}(r)||function(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||N(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(r,e){return function(r){if(Array.isArray(r))return r}(r)||function(r,e){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var n,o,i,s,a=[],c=!0,u=!1;try{if(i=(t=t.call(r)).next,0===e){if(Object(t)!==t)return;c=!1}else for(;!(c=(n=i.call(t)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(r){u=!0,o=r}finally{try{if(!c&&null!=t.return&&(s=t.return(),Object(s)!==s))return}finally{if(u)throw o}}return a}}(r,e)||N(r,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(r,e){var t;if(r)return"string"==typeof r?n(r,e):"Map"===(t="Object"===(t=Object.prototype.toString.call(r).slice(8,-1))&&r.constructor?r.constructor.name:t)||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?n(r,e):void 0}function n(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function T(){T=function(){return s};var s={},r=Object.prototype,c=r.hasOwnProperty,u=Object.defineProperty||function(r,e,t){r[e]=t.value},e="function"==typeof Symbol?Symbol:{},n=e.iterator||"@@iterator",t=e.asyncIterator||"@@asyncIterator",o=e.toStringTag||"@@toStringTag";function i(r,e,t){return Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}),r[e]}try{i({},"")}catch(r){i=function(r,e,t){return r[e]=t}}function a(r,e,t,n){var o,i,s,a,e=e&&e.prototype instanceof p?e:p,e=Object.create(e.prototype),n=new m(n||[]);return u(e,"_invoke",{value:(o=r,i=t,s=n,a="suspendedStart",function(r,e){if("executing"===a)throw new Error("Generator is already running");if("completed"===a){if("throw"===r)throw e;return w()}for(s.method=r,s.arg=e;;){var t=s.delegate;if(t){t=function r(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,r(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;n=l(o,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,h;o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}(t,s);if(t){if(t===h)continue;return t}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if("suspendedStart"===a)throw a="completed",s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);a="executing";t=l(o,i,s);if("normal"===t.type){if(a=s.done?"completed":"suspendedYield",t.arg===h)continue;return{value:t.arg,done:s.done}}"throw"===t.type&&(a="completed",s.method="throw",s.arg=t.arg)}})}),e}function l(r,e,t){try{return{type:"normal",arg:r.call(e,t)}}catch(r){return{type:"throw",arg:r}}}s.wrap=a;var h={};function p(){}function f(){}function _(){}var e={},d=(i(e,n,function(){return this}),Object.getPrototypeOf),d=d&&d(d(P([]))),E=(d&&d!==r&&c.call(d,n)&&(e=d),_.prototype=p.prototype=Object.create(e));function y(r){["next","throw","return"].forEach(function(e){i(r,e,function(r){return this._invoke(e,r)})})}function b(s,a){var e;u(this,"_invoke",{value:function(t,n){function r(){return new a(function(r,e){!function e(r,t,n,o){var i,r=l(s[r],s,t);if("throw"!==r.type)return(t=(i=r.arg).value)&&"object"==A(t)&&c.call(t,"__await")?a.resolve(t.__await).then(function(r){e("next",r,n,o)},function(r){e("throw",r,n,o)}):a.resolve(t).then(function(r){i.value=r,n(i)},function(r){return e("throw",r,n,o)});o(r.arg)}(t,n,r,e)})}return e=e?e.then(r,r):r()}})}function v(r){var e={tryLoc:r[0]};1 in r&&(e.catchLoc=r[1]),2 in r&&(e.finallyLoc=r[2],e.afterLoc=r[3]),this.tryEntries.push(e)}function S(r){var e=r.completion||{};e.type="normal",delete e.arg,r.completion=e}function m(r){this.tryEntries=[{tryLoc:"root"}],r.forEach(v,this),this.reset(!0)}function P(e){if(e){var t,r=e[n];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return t=-1,(r=function r(){for(;++t<e.length;)if(c.call(e,t))return r.value=e[t],r.done=!1,r;return r.value=void 0,r.done=!0,r}).next=r}return{next:w}}function w(){return{value:void 0,done:!0}}return u(E,"constructor",{value:f.prototype=_,configurable:!0}),u(_,"constructor",{value:f,configurable:!0}),f.displayName=i(_,o,"GeneratorFunction"),s.isGeneratorFunction=function(r){r="function"==typeof r&&r.constructor;return!!r&&(r===f||"GeneratorFunction"===(r.displayName||r.name))},s.mark=function(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,_):(r.__proto__=_,i(r,o,"GeneratorFunction")),r.prototype=Object.create(E),r},s.awrap=function(r){return{__await:r}},y(b.prototype),i(b.prototype,t,function(){return this}),s.AsyncIterator=b,s.async=function(r,e,t,n,o){void 0===o&&(o=Promise);var i=new b(a(r,e,t,n),o);return s.isGeneratorFunction(e)?i:i.next().then(function(r){return r.done?r.value:i.next()})},y(E),i(E,o,"Generator"),i(E,n,function(){return this}),i(E,"toString",function(){return"[object Generator]"}),s.keys=function(r){var e,t=Object(r),n=[];for(e in t)n.push(e);return n.reverse(),function r(){for(;n.length;){var e=n.pop();if(e in t)return r.value=e,r.done=!1,r}return r.done=!0,r}},s.values=P,m.prototype={constructor:m,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!r)for(var e in this)"t"===e.charAt(0)&&c.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var r=this.tryEntries[0].completion;if("throw"===r.type)throw r.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(r,e){return i.type="throw",i.arg=t,n.next=r,e&&(n.method="next",n.arg=void 0),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var o=this.tryEntries[e],i=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=c.call(o,"catchLoc"),a=c.call(o,"finallyLoc");if(s&&a){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(r,e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.tryLoc<=this.prev&&c.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}var i=(o=o&&("break"===r||"continue"===r)&&o.tryLoc<=e&&e<=o.finallyLoc?null:o)?o.completion:{};return i.type=r,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(i)},complete:function(r,e){if("throw"===r.type)throw r.arg;return"break"===r.type||"continue"===r.type?this.next=r.arg:"return"===r.type?(this.rval=this.arg=r.arg,this.method="return",this.next="end"):"normal"===r.type&&e&&(this.next=e),h},finish:function(r){for(var e=this.tryEntries.length-1;0<=e;--e){var t=this.tryEntries[e];if(t.finallyLoc===r)return this.complete(t.completion,t.afterLoc),S(t),h}},catch:function(r){for(var e=this.tryEntries.length-1;0<=e;--e){var t,n,o=this.tryEntries[e];if(o.tryLoc===r)return"throw"===(t=o.completion).type&&(n=t.arg,S(o)),n}throw new Error("illegal catch attempt")},delegateYield:function(r,e,t){return this.delegate={iterator:P(r),resultName:e,nextLoc:t},"next"===this.method&&(this.arg=void 0),h}},s}function c(r,e,t,n,o,i,s){try{var a=r[i](s),c=a.value}catch(r){return void t(r)}a.done?e(c):Promise.resolve(c).then(n,o)}function L(a){return function(){var r=this,s=arguments;return new Promise(function(e,t){var n=a.apply(r,s);function o(r){c(n,e,t,o,i,"next",r)}function i(r){c(n,e,t,o,i,"throw",r)}o(void 0)})}}function o(e,r){var t,n=Object.keys(e);return Object.getOwnPropertySymbols&&(t=Object.getOwnPropertySymbols(e),r&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,t)),n}function W(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?o(Object(t),!0).forEach(function(r){B(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function B(r,e,t){(e=i(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t}function j(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,i(n.key),n)}}function i(r){r=function(r,e){if("object"!==A(r)||null===r)return r;var t=r[Symbol.toPrimitive];if(void 0===t)return("string"===e?String:Number)(r);t=t.call(r,e||"default");if("object"!==A(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}(r,"string");return"symbol"===A(r)?r:String(r)}var G=new M.JsonSerializer,r=function(){function t(r,e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.version="v7.0.2",this._url="string"==typeof r?r:null,this._protocols=["wamp.2.json"],this._wamp_features={agent:"Wampy.js "+this.version,roles:{publisher:{features:{subscriber_blackwhite_listing:!0,publisher_exclusion:!0,publisher_identification:!0,payload_passthru_mode:!0}},subscriber:{features:{pattern_based_subscription:!0,publication_trustlevels:!0,publisher_identification:!0,payload_passthru_mode:!0}},caller:{features:{caller_identification:!0,progressive_call_results:!0,call_canceling:!0,call_timeout:!0,payload_passthru_mode:!0}},callee:{features:{caller_identification:!0,call_trustlevels:!0,pattern_based_registration:!0,shared_registration:!0,payload_passthru_mode:!0}}}},this._cache={sessionId:null,reqId:0,server_wamp_features:{roles:{}},isSayingGoodbye:!1,opStatus:{code:0,error:null,reqId:0},timer:null,reconnectingAttempts:0,connectPromise:null,closePromise:null},this._ws=null,this._wsQueue=[],this._requests={},this._calls={},this._subscriptionsById=new Map,this._subscriptionsByKey=new Map,this._rpcRegs={},this._rpcNames=new Set,this._options={debug:!1,logger:null,autoReconnect:!0,reconnectInterval:2e3,maxRetries:25,realm:null,helloCustomDetails:null,uriValidation:"strict",authid:null,authmethods:[],authextra:{},authPlugins:{},authMode:"manual",onChallenge:null,onClose:null,onError:null,onReconnect:null,onReconnectSuccess:null,ws:null,additionalHeaders:null,wsRequestOptions:null,serializer:G,payloadSerializers:{json:G}},this._isPlainObject(e)?this._options=W(W({},this._options),e):this._isPlainObject(r)&&(this._options=W(W({},this._options),r))}var r,e,n,o,i,s,a,c,u,l,h,p,f,_,d,E,y,b,v,S,m,P,w,g,R;return r=t,(e=[{key:"_log",value:function(){if(this._options.debug){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return this._options.logger?this._options.logger(e):void 0}}},{key:"_getReqId",value:function(){return++this._cache.reqId}},{key:"_isPlainObject",value:function(r){var e=null==r?void 0:r.constructor,t=null==e?void 0:e.prototype;return"[object Object]"===Object.prototype.toString.call(r)&&"function"==typeof e&&"[object Object]"===Object.prototype.toString.call(t)&&Object.hasOwnProperty.call(t,"isPrototypeOf")}},{key:"_setWsProtocols",value:function(){this._protocols=["wamp.2."+this._options.serializer.protocol]}},{key:"_fillOpStatusByError",value:function(r){this._cache.opStatus={code:r.code,error:r,reqId:0}}},{key:"_preReqChecks",value:function(r,e){var t;return this._cache.sessionId&&!this._cache.server_wamp_features.roles[e]?(t={dealer:new k.NoDealerError,broker:new k.NoBrokerError},this._fillOpStatusByError(t[e]),!1):!(r&&!this._validateURI(r.topic,r.patternBased,r.allowWAMP))||(this._fillOpStatusByError(new k.UriError),!1)}},{key:"_checkRouterFeature",value:function(r,e){return!0===this._cache.server_wamp_features.roles[r].features[e]||(this._fillOpStatusByError(new k.FeatureNotSupportedError(r,e)),!1)}},{key:"_checkPPTOptions",value:function(r,e){return this._checkRouterFeature(r,"payload_passthru_mode")?e.ppt_scheme.search(/^(wamp$|mqtt$|x_)/)<0?(this._fillOpStatusByError(new k.PPTInvalidSchemeError),!1):!("wamp"===e.ppt_scheme&&!O.E2EE_SERIALIZERS.includes(e.ppt_serializer))||(this._fillOpStatusByError(new k.PPTSerializerInvalidError),!1):(this._fillOpStatusByError(new k.PPTNotSupportedError),!1)}},{key:"_validateURI",value:function(r,e,t){var n,o,i="strict"===this._options.uriValidation,s="loose"===this._options.uriValidation;return!(!i&&!s||r.startsWith("wamp.")&&!t)&&(i?(n=/^(\w+\.)*(\w+)$/,o=/^(\w+\.{1,2})*(\w+)$/):s&&(n=/^([^\s.#]+\.)*([^\s.#]+)$/,o=/^([^\s.#]+\.{1,2})*([^\s.#]+)$/),(e?o:n).test(r))}},{key:"_packPPTPayload",value:function(r,e){var t=(null==r?void 0:r.argsList)&&!Array.isArray(r.argsList),n=(null==r?void 0:r.argsDict)&&!this._isPlainObject(r.argsDict);if(t||n)return n=t?r.argsList:r.argsDict,this._fillOpStatusByError(new k.InvalidParamError(n)),{err:!0,payloadItems:[]};var o,i,t=this._isPlainObject(r),n=r.argsList,s=r.argsDict,t=(!t||n||s?t?(o=n,i=s):o=Array.isArray(r)?r:[r]:i=r,[]);if(e.ppt_scheme){n={args:o,kwargs:i},s=n;if(e.ppt_serializer&&"native"!==e.ppt_serializer){r=this._options.payloadSerializers[e.ppt_serializer];if(!r)return this._fillOpStatusByError(new k.PPTSerializerInvalidError),{err:!0,payloadItems:t};try{s=r.encode(n)}catch(r){return this._fillOpStatusByError(new k.PPTSerializationError),{err:!0,payloadItems:t}}}t.push([s])}else o&&t.push(o),i&&(o||t.push([]),t.push(i));return{err:!1,payloadItems:t}}},{key:"_unpackPPTPayload",value:function(r,e,t){var n;if(!this._checkPPTOptions(r,t))return{err:this._cache.opStatus.error};if(t.ppt_serializer&&"native"!==t.ppt_serializer){r=this._options.payloadSerializers[t.ppt_serializer];if(!r)return{err:new k.PPTSerializerInvalidError};try{n=r.decode(e)}catch(r){return{err:new k.PPTSerializationError}}}else n=e;return{err:!1,args:n.args,kwargs:n.kwargs}}},{key:"_encode",value:function(r){try{return this._options.serializer.encode(r)}catch(r){this._hardClose("wamp.error.protocol_violation","Can not encode message",!0)}}},{key:"_decode",value:function(r){try{return this._options.serializer.decode(r)}catch(r){this._hardClose("wamp.error.protocol_violation","Can not decode received message")}}},{key:"_hardClose",value:function(r,e){var t=2<arguments.length&&void 0!==arguments[2]&&arguments[2],t=(this._log(e),this._wsQueue=[],t||this._send([O.WAMP_MSG_SPEC.ABORT,{message:e},r]),new k.ProtocolViolationError(r,e));this._cache.connectPromise&&(this._cache.connectPromise.onError(t),this._cache.connectPromise=null),this._options.onError&&this._options.onError(t),this._ws.close()}},{key:"_send",value:function(r){if(r&&this._wsQueue.push(this._encode(r)),this._ws&&1===this._ws.readyState&&this._cache.sessionId)for(;this._wsQueue.length;)this._ws.send(this._wsQueue.shift())}},{key:"_resetState",value:function(){this._wsQueue=[],this._subscriptionsById.clear(),this._subscriptionsByKey.clear(),this._requests={},this._calls={},this._rpcRegs={},this._rpcNames=new Set,this._cache={reqId:0,reconnectingAttempts:0,opStatus:O.SUCCESS,closePromise:null,connectPromise:null}}},{key:"_initWsCallbacks",value:function(){var e=this;this._ws.onopen=function(){return e._wsOnOpen()},this._ws.onclose=function(r){return e._wsOnClose(r)},this._ws.onmessage=function(r){return e._wsOnMessage(r)},this._ws.onerror=function(r){return e._wsOnError(r)}}},{key:"_wsOnOpen",value:function(){var r=this._options,e=r.helloCustomDetails,t=r.authmethods,n=r.authid,o=r.authextra,i=r.serializer,s=r.onError,r=r.realm,a=null==(a=this._ws.protocol)||null==(a=a.split("."))?void 0:a[2],c=a===i.protocol,a=(this._log('Websocket connected. Server has chosen protocol: "'.concat(a,'"')),c||("json"===a?this._options.serializer=new M.JsonSerializer:(c=new k.NoSerializerAvailableError,this._fillOpStatusByError(c),this._cache.connectPromise&&(this._cache.connectPromise.onError(c),this._cache.connectPromise=null),s&&s(c))),i.isBinary&&(this._ws.binaryType="arraybuffer"),W(W(W({},e),this._wamp_features),n?{authid:n,authmethods:t,authextra:o}:{})),s=this._encode([O.WAMP_MSG_SPEC.HELLO,r,a]);s&&this._ws.send(s)}},{key:"_wsOnClose",value:function(r){var e=this;this._log("websocket disconnected. Info: ",r),(this._cache.sessionId||this._cache.reconnectingAttempts)&&this._options.autoReconnect&&(0===this._options.maxRetries||this._cache.reconnectingAttempts<this._options.maxRetries)&&!this._cache.isSayingGoodbye?(this._cache.sessionId=null,this._cache.timer=setTimeout(function(){e._wsReconnect()},this._options.reconnectInterval)):(this._options.onClose?this._options.onClose():this._cache.closePromise&&(this._cache.closePromise.onSuccess(),this._cache.closePromise=null),this._resetState(),this._ws=null)}},{key:"_wsOnMessage",value:(R=L(T().mark(function r(e){var t,n,o,i,s,a,c=this;return T().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t=this._decode(e.data),this._log("websocket message received: ",t),n=t[0],B(o={},O.WAMP_MSG_SPEC.WELCOME,function(){return c._onWelcomeMessage(t)}),B(o,O.WAMP_MSG_SPEC.ABORT,function(){return c._onAbortMessage(t)}),B(o,O.WAMP_MSG_SPEC.CHALLENGE,function(){return c._onChallengeMessage(t)}),B(o,O.WAMP_MSG_SPEC.GOODBYE,function(){return c._onGoodbyeMessage(t)}),B(o,O.WAMP_MSG_SPEC.ERROR,function(){return c._onErrorMessage(t)}),B(o,O.WAMP_MSG_SPEC.SUBSCRIBED,function(){return c._onSubscribedMessage(t)}),B(o,O.WAMP_MSG_SPEC.UNSUBSCRIBED,function(){return c._onUnsubscribedMessage(t)}),B(o,O.WAMP_MSG_SPEC.PUBLISHED,function(){return c._onPublishedMessage(t)}),B(o,O.WAMP_MSG_SPEC.EVENT,function(){return c._onEventMessage(t)}),B(o,O.WAMP_MSG_SPEC.RESULT,function(){return c._onResultMessage(t)}),B(o,O.WAMP_MSG_SPEC.REGISTERED,function(){return c._onRegisteredMessage(t)}),B(o,O.WAMP_MSG_SPEC.UNREGISTERED,function(){return c._onUnregisteredMessage(t)}),B(o,O.WAMP_MSG_SPEC.INVOCATION,function(){return c._onInvocationMessage(t)}),i="wamp.error.protocol_violation",o=o[n]){r.next=8;break}return r.abrupt("return",this._hardClose(i,'Received non-compliant WAMP message: "'.concat(n,'"')));case 8:if(s=[O.WAMP_MSG_SPEC.WELCOME,O.WAMP_MSG_SPEC.CHALLENGE].includes(n),a=!s&&n!==O.WAMP_MSG_SPEC.ABORT,s&&this._cache.sessionId)return r.abrupt("return",this._hardClose(i,'Received message "'.concat(n,'" after session was established')));r.next=12;break;case 12:if(a&&!this._cache.sessionId)return r.abrupt("return",this._hardClose(i,'Received message "'.concat(n,'" before session was established')));r.next=14;break;case 14:return r.next=16,o();case 16:case"end":return r.stop()}},r,this)})),function(r){return R.apply(this,arguments)})},{key:"_onWelcomeMessage",value:(g=L(T().mark(function r(e){var t,n;return T().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n=x(e,3),t=n[1],n=n[2],this._cache.sessionId=t,this._cache.server_wamp_features=n,this._cache.reconnectingAttempts){if(this._cache.reconnectingAttempts=0,this._options.onReconnectSuccess)return r.next=8,this._options.onReconnectSuccess(n);r.next=8}else r.next=12;break;case 8:this._renewSubscriptions(),this._renewRegistrations(),r.next=14;break;case 12:this._cache.connectPromise.onSuccess(n),this._cache.connectPromise=null;case 14:this._send();case 15:case"end":return r.stop()}},r,this)})),function(r){return g.apply(this,arguments)})},{key:"_onAbortMessage",value:(w=L(T().mark(function r(e){var t,n;return T().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n=x(e,3),t=n[1],n=n[2],n=new k.AbortError({error:n,details:t}),this._cache.connectPromise&&(this._cache.connectPromise.onError(n),this._cache.connectPromise=null),this._options.onError)return r.next=6,this._options.onError(n);r.next=6;break;case 6:this._ws.close();case 7:case"end":return r.stop()}},r,this)})),function(r){return w.apply(this,arguments)})},{key:"_onChallengeMessage",value:(P=L(T().mark(function r(e){var t,n,o,i,s,a,c,u,l,h;return T().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:l=x(e,3),t=l[1],n=l[2],l=this._options,i=l.authid,s=l.authMode,a=l.onChallenge,c=l.onError,u=l.authPlugins,i&&"manual"===s&&"function"==typeof a?(o=new Promise(function(r){r(a(t,n))}),r.next=17):r.next=6;break;case 6:i&&"auto"===s&&"function"==typeof u[t]?(o=new Promise(function(r){r(u[t](t,n))}),r.next=17):r.next=10;break;case 10:if(l=new k.NoCRACallbackOrIdError,this._fillOpStatusByError(l),this._ws.send(this._encode([O.WAMP_MSG_SPEC.ABORT,{message:l.message},"wamp.error.cannot_authenticate"])),c)return r.next=16,c(l);r.next=16;break;case 16:return r.abrupt("return",this._ws.close());case 17:return r.prev=17,r.next=20,o;case 20:h=r.sent,this._ws.send(this._encode([O.WAMP_MSG_SPEC.AUTHENTICATE,h,{}])),r.next=33;break;case 24:if(r.prev=24,r.t0=r.catch(17),h=new k.ChallengeExceptionError,this._fillOpStatusByError(h),this._ws.send(this._encode([O.WAMP_MSG_SPEC.ABORT,{message:h.message},"wamp.error.cannot_authenticate"])),c)return r.next=32,c(h);r.next=32;break;case 32:this._ws.close();case 33:case"end":return r.stop()}},r,this,[[17,24]])})),function(r){return P.apply(this,arguments)})},{key:"_onGoodbyeMessage",value:(m=L(T().mark(function r(){return T().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:this._cache.isSayingGoodbye||(this._cache.isSayingGoodbye=!0,this._send([O.WAMP_MSG_SPEC.GOODBYE,{},"wamp.close.goodbye_and_out"])),this._cache.sessionId=null,this._ws.close();case 3:case"end":return r.stop()}},r,this)})),function(){return m.apply(this,arguments)})},{key:"_onErrorMessage",value:(S=L(T().mark(function r(e){var t,n,o,i,s,a;return T().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=x(e,7),t=i[1],n=i[2],a=i[3],s=i[4],o=i[5],i=i[6],s={error:s,details:a,argsList:o,argsDict:i},B(a={},O.WAMP_MSG_SPEC.SUBSCRIBE,new k.SubscribeError(s)),B(a,O.WAMP_MSG_SPEC.UNSUBSCRIBE,new k.UnsubscribeError(s)),B(a,O.WAMP_MSG_SPEC.PUBLISH,new k.PublishError(s)),B(a,O.WAMP_MSG_SPEC.REGISTER,new k.RegisterError(s)),B(a,O.WAMP_MSG_SPEC.UNREGISTER,new k.UnregisterError(s)),B(a,O.WAMP_MSG_SPEC.CALL,new k.CallError(s)),o=a[t]){r.next=6;break}return r.abrupt("return",this._hardClose("wamp.error.protocol_violation","Received invalid ERROR message"));case 6:if(t!==O.WAMP_MSG_SPEC.CALL)r.next=13;else{if(null!=(i=this._calls[n])&&i.onError)return r.next=10,this._calls[n].onError(o);r.next=10}break;case 10:delete this._calls[n],r.next=17;break;case 13:if(null!=(s=this._requests[n])&&null!=(a=s.callbacks)&&a.onError)return r.next=16,this._requests[n].callbacks.onError(o);r.next=16;break;case 16:delete this._requests[n];case 17:case"end":return r.stop()}},r,this)})),function(r){return S.apply(this,arguments)})},{key:"_onSubscribedMessage",value:(v=L(T().mark(function r(e){var t,n,o,i,s,a;return T().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n=x(e,3),t=n[1],n=n[2],this._requests[t]){r.next=3;break}return r.abrupt("return");case 3:if(i=this._requests[t],o=i.topic,a=i.advancedOptions,i=i.callbacks,s={id:n,topic:o,advancedOptions:a,callbacks:[i.onEvent]},a=this._getSubscriptionKey(o,a),this._subscriptionsById.set(n,s),this._subscriptionsByKey.set(a,s),i.onSuccess)return r.next=11,i.onSuccess({topic:o,requestId:t,subscriptionId:n,subscriptionKey:a});r.next=11;break;case 11:delete this._requests[t];case 12:case"end":return r.stop()}},r,this)})),function(r){return v.apply(this,arguments)})},{key:"_onUnsubscribedMessage",value:(b=L(T().mark(function r(e){var t,n,o,i,s;return T().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t=x(e,2),t=t[1],this._requests[t]){r.next=3;break}return r.abrupt("return");case 3:if(o=this._requests[t],n=o.topic,i=o.advancedOptions,o=o.callbacks,i=this._getSubscriptionKey(n,i),s=this._subscriptionsByKey.get(i).id,this._subscriptionsByKey.delete(i),this._subscriptionsById.delete(s),o.onSuccess)return r.next=11,o.onSuccess({topic:n,requestId:t});r.next=11;break;case 11:delete this._requests[t];case 12:case"end":return r.stop()}},r,this)})),function(r){return b.apply(this,arguments)})},{key:"_onPublishedMessage",value:(y=L(T().mark(function r(e){var t,n,o,i;return T().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n=x(e,3),t=n[1],n=n[2],this._requests[t]){r.next=3;break}return r.abrupt("return");case 3:if(i=this._requests[t],o=i.topic,null!=(i=i.callbacks)&&i.onSuccess)return r.next=7,i.onSuccess({topic:o,requestId:t,publicationId:n});r.next=7;break;case 7:delete this._requests[t];case 8:case"end":return r.stop()}},r,this)})),function(r){return y.apply(this,arguments)})},{key:"_onEventMessage",value:(E=L(T().mark(function r(e){var t,n,o,i,s,a,c,u,l;return T().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(o=x(e,6),i=o[1],o[2],t=o[3],n=o[4],o=o[5],i=this._subscriptionsById.get(i)){r.next=4;break}return r.abrupt("return");case 4:if(s=n,a=o,t.ppt_scheme){if(c=n[0],(c=this._unpackPPTPayload("broker",c,t)).err)return r.abrupt("return",this._log(c.err.message));r.next=11}else r.next=13;break;case 11:s=c.args,a=c.kwargs;case 13:return u={details:t,argsList:s,argsDict:a},l=i.callbacks.map(function(r){return r(u)}),r.next=17,Promise.all(l);case 17:case"end":return r.stop()}},r,this)})),function(r){return E.apply(this,arguments)})},{key:"_onResultMessage",value:(d=L(T().mark(function r(e){var t,n,o,i,s,a,c,u;return T().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=x(e,5),t=i[1],n=i[2],o=i[3],i=i[4],this._calls[t]){r.next=3;break}return r.abrupt("return");case 3:if(s=o,a=i,n.ppt_scheme){if(c=o[0],(c=this._unpackPPTPayload("dealer",c,n)).err)return this._log(c.err.message),this._cache.opStatus=c.err,r.next=13,this._calls[t].onError(new k.CallError({details:n,error:"wamp.error.invocation_exception",argsList:[c.err.message],argsDict:null}));r.next=15}else r.next=17;break;case 13:return delete this._calls[t],r.abrupt("return");case 15:s=c.args,a=c.kwargs;case 17:if(u={details:n,argsList:s,argsDict:a},n.progress)return r.next=21,this._calls[t].onProgress(u);r.next=23;break;case 21:r.next=26;break;case 23:return r.next=25,this._calls[t].onSuccess(u);case 25:delete this._calls[t];case 26:case"end":return r.stop()}},r,this)})),function(r){return d.apply(this,arguments)})},{key:"_onRegisteredMessage",value:(_=L(T().mark(function r(e){var t,n,o,i;return T().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n=x(e,3),t=n[1],n=n[2],this._requests[t]){r.next=3;break}return r.abrupt("return");case 3:if(i=this._requests[t],o=i.topic,i=i.callbacks,this._rpcRegs[n]={id:n,callbacks:[i.rpc]},this._rpcRegs[o]=this._rpcRegs[n],this._rpcNames.add(o),null!=i&&i.onSuccess)return r.next=10,i.onSuccess({topic:o,requestId:t,registrationId:n});r.next=10;break;case 10:delete this._requests[t];case 11:case"end":return r.stop()}},r,this)})),function(r){return _.apply(this,arguments)})},{key:"_onUnregisteredMessage",value:(f=L(T().mark(function r(e){var t,n,o;return T().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t=x(e,2),t=t[1],this._requests[t]){r.next=3;break}return r.abrupt("return");case 3:if(o=this._requests[t],n=o.topic,o=o.callbacks,delete this._rpcRegs[this._rpcRegs[n].id],delete this._rpcRegs[n],this._rpcNames.has(n)&&this._rpcNames.delete(n),null!=o&&o.onSuccess)return r.next=10,o.onSuccess({topic:n,requestId:t});r.next=10;break;case 10:delete this._requests[t];case 11:case"end":return r.stop()}},r,this)})),function(r){return f.apply(this,arguments)})},{key:"_onInvocationMessage",value:(p=L(T().mark(function r(e){var a,t,n,o,i,c,u,s,l,h,p,f,_=this;return T().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=x(e,6),a=i[1],t=i[2],n=i[3],o=i[4],i=i[5],u=function(r){var e=r.error,t=r.details,n=r.argsList,r=r.argsDict,t=[O.WAMP_MSG_SPEC.ERROR,O.WAMP_MSG_SPEC.INVOCATION,a,t||{},e||"wamp.error.invocation_exception"];Array.isArray(n)&&t.push(n),c._isPlainObject(r)&&(Array.isArray(n)||t.push([]),t.push(r)),c._send(t)},(c=this)._rpcRegs[t]){r.next=6;break}return this._log(O.WAMP_ERROR_MSG.NON_EXIST_RPC_INVOCATION),r.abrupt("return",u({error:"wamp.error.no_such_procedure"}));case 6:if(s=o,l=i,null!=n&&n.ppt_scheme)if(h=o[0],(h=this._unpackPPTPayload("dealer",h,n)).err){if(this._log(h.err.message),h.err instanceof k.PPTNotSupportedError)return r.abrupt("return",this._hardClose("wamp.error.protocol_violation","Received INVOCATION in PPT Mode, while Dealer didn't announce it"));r.next=15}else r.next=16;else r.next=18;break;case 15:return r.abrupt("return",u({details:n,error:"wamp.error.invocation_exception",argsList:[h.err.message]}));case 16:s=h.args,l=h.kwargs;case 18:return p=function(r){var e,t=(null==r?void 0:r.options)||{},n=t.ppt_scheme,o=t.ppt_serializer,i=t.ppt_cipher,s=t.ppt_keyid;return n&&!_._checkPPTOptions("dealer",t)?_._cache.opStatus.error instanceof k.PPTNotSupportedError?_._hardClose("wamp.error.protocol_violation","Trying to send YIELD in PPT Mode, while Dealer didn't announce it"):u({details:t,error:"wamp.error.invalid_option",argsList:[_._cache.opStatus.error.message]}):(e=(r=r?_._packPPTPayload(r,t):{}).err,r=r.payloadItems,e?u({details:t,error:"wamp.error.invocation_exception",argsList:[_._cache.opStatus.error.message]}):(e=W(W(W(W(W({},t),n?{ppt_scheme:n}:{}),o?{ppt_serializer:o}:{}),i?{ppt_cipher:i}:{}),s?{ppt_keyid:s}:{}),void c._send([O.WAMP_MSG_SPEC.YIELD,a,e].concat(I(r||[])))))},r.prev=19,r.next=22,this._rpcRegs[t].callbacks[0]({details:n,argsList:s,argsDict:l,result_handler:p,error_handler:u});case 22:f=r.sent,p(f),r.next=29;break;case 26:r.prev=26,r.t0=r.catch(19),u(r.t0);case 29:case"end":return r.stop()}},r,this,[[19,26]])})),function(r){return p.apply(this,arguments)})},{key:"_wsOnError",value:function(r){this._log("websocket error");r=new k.WebsocketError(r);this._cache.connectPromise&&(this._cache.connectPromise.onError(r),this._cache.connectPromise=null),this._options.onError&&this._options.onError(r)}},{key:"_wsReconnect",value:function(){this._log("websocket reconnecting..."),this._options.onReconnect&&this._options.onReconnect(),this._cache.reconnectingAttempts++,this._ws=(0,C.getWebSocket)({url:this._url,protocols:this._protocols,options:this._options}),this._initWsCallbacks()}},{key:"_renewSubscriptions",value:function(){var e,t=this,r=new Map(this._subscriptionsById);this._subscriptionsById.clear(),this._subscriptionsByKey.clear(),r.forEach(function(r){for(e=r.callbacks.length;e--;)t.subscribe(r.topic,r.callbacks[e],r.advancedOptions)})}},{key:"_renewRegistrations",value:function(){var r,e=this._rpcRegs,t=this._rpcNames,n=(this._rpcRegs={},this._rpcNames=new Set,function(r,e){var t,n,o,i,s="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(s)return n=!(t=!0),{s:function(){s=s.call(r)},n:function(){var r=s.next();return t=r.done,r},e:function(r){n=!0,o=r},f:function(){try{t||null==s.return||s.return()}finally{if(n)throw o}}};if(Array.isArray(r)||(s=N(r))||e&&r&&"number"==typeof r.length)return s&&(r=s),i=0,{s:e=function(){},n:function(){return i>=r.length?{done:!0}:{done:!1,value:r[i++]}},e:function(r){throw r},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(t));try{for(n.s();!(r=n.n()).done;){var o=r.value;this.register(o,e[o].callbacks[0])}}catch(r){n.e(r)}finally{n.f()}}},{key:"_getSubscriptionKey",value:function(r,e){return"".concat(r,"-").concat(JSON.stringify(e))}},{key:"options",value:function(r){return void 0===r?this._options:this._isPlainObject(r)?(this._options=W(W({},this._options),r),this):void 0}},{key:"getOptions",value:function(){return this._options}},{key:"setOptions",value:function(r){if(this._isPlainObject(r))return this._options=W(W({},this._options),r),this}},{key:"getOpStatus",value:function(){return this._cache.opStatus}},{key:"getSessionId",value:function(){return this._cache.sessionId}},{key:"connect",value:(h=L(T().mark(function r(e){var t,n,o;return T().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e&&(this._url=e),this._options.realm){r.next=5;break}throw t=new k.NoRealmError,this._fillOpStatusByError(t),t;case 5:if(0<(t=(this._options.authid?1:0)+(Array.isArray(this._options.authmethods)&&this._options.authmethods.length?1:0)+("function"==typeof this._options.onChallenge||Object.keys(this._options.authPlugins).length?1:0))&&t<3)throw n=new k.NoCRACallbackOrIdError,this._fillOpStatusByError(n),n;r.next=10;break;case 10:if(this._setWsProtocols(),this._ws=(0,C.getWebSocket)({url:this._url,protocols:this._protocols,options:this._options}),this._ws){r.next=16;break}throw n=new k.NoWsOrUrlError,this._fillOpStatusByError(n),n;case 16:return this._initWsCallbacks(),o=(0,C.getNewPromise)(),this._cache.connectPromise=o,r.abrupt("return",o.promise);case 20:case"end":return r.stop()}},r,this)})),function(r){return h.apply(this,arguments)})},{key:"disconnect",value:(l=L(T().mark(function r(){var e;return T().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(this._cache.sessionId)return e=(0,C.getNewPromise)(),this._cache.opStatus=O.SUCCESS,this._cache.closePromise=e,this._cache.isSayingGoodbye=!0,this._send([O.WAMP_MSG_SPEC.GOODBYE,{},"wamp.close.system_shutdown"]),r.abrupt("return",e.promise);r.next=9;break;case 9:this._ws&&this._ws.close();case 10:return r.abrupt("return",!0);case 11:case"end":return r.stop()}},r,this)})),function(){return l.apply(this,arguments)})},{key:"abort",value:function(){return this._cache.sessionId||1!==this._ws.readyState||(this._send([O.WAMP_MSG_SPEC.ABORT,{},"wamp.error.abort"]),this._cache.sessionId=null),this._ws.close(),this._cache.opStatus=O.SUCCESS,this}},{key:"subscribe",value:(u=L(T().mark(function r(e,t,n){var o,i,s,a,c,u,l;return T().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if((o=this._isPlainObject(n))||void 0===n){r.next=5;break}throw a=new k.InvalidParamError("advancedOptions"),this._fillOpStatusByError(a),a;case 5:if(s=!1,!o||!Object.prototype.hasOwnProperty.call(n,"match")){r.next=13;break}if(["prefix","wildcard"].includes(n.match)){r.next=11;break}throw a=new k.InvalidParamError("match"),this._fillOpStatusByError(a),a;case 11:i=n.match,s=!0;case 13:if(this._preReqChecks({topic:e,patternBased:s,allowWAMP:!0},"broker")){r.next=15;break}throw this._cache.opStatus.error;case 15:if("function"!=typeof t)throw c=new k.NoCallbackError,this._fillOpStatusByError(c),c;r.next=19;break;case 19:if(c=this._getSubscriptionKey(e,n),(u=this._subscriptionsByKey.get(c))&&0<u.callbacks.length)return u.callbacks.includes(t)||u.callbacks.push(t),r.abrupt("return",{topic:e,requestId:0,subscriptionId:u.id,subscriptionKey:c});r.next=24;break;case 24:return u=this._getReqId(),(l=(0,C.getNewPromise)()).onEvent=t,this._requests[u]={topic:e,callbacks:l,advancedOptions:n},this._send([O.WAMP_MSG_SPEC.SUBSCRIBE,u,{match:i},e]),this._cache.opStatus=W(W({},O.SUCCESS),{},{reqId:u||0}),r.abrupt("return",l.promise);case 31:case"end":return r.stop()}},r,this)})),function(r,e,t){return u.apply(this,arguments)})},{key:"unsubscribe",value:(c=L(T().mark(function r(e,t){var n,o;return T().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(this._preReqChecks(null,"broker")){r.next=2;break}throw this._cache.opStatus.error;case 2:if(n=this._subscriptionsById.get(e)||this._subscriptionsByKey.get(e)){r.next=7;break}throw o=new k.NonExistUnsubscribeError,this._fillOpStatusByError(o),o;case 7:if(n.callbacks="function"==typeof t?n.callbacks.filter(function(r){return r!==t}):[],0<n.callbacks.length)return this._cache.opStatus=O.SUCCESS,r.abrupt("return",!0);r.next=12;break;case 12:return o=this._getReqId(),this._requests[o]={topic:n.topic,callbacks:(0,C.getNewPromise)()},this._send([O.WAMP_MSG_SPEC.UNSUBSCRIBE,o,n.id]),this._cache.opStatus=W(W({},O.SUCCESS),{},{reqId:o}),r.abrupt("return",this._requests[o].callbacks.promise);case 17:case"end":return r.stop()}},r,this)})),function(r,e){return c.apply(this,arguments)})},{key:"publish",value:(a=L(T().mark(function r(e,t,n){var o,i,s,a,c,u,l,h,p,f,_,d,E;return T().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(this._preReqChecks({topic:e,patternBased:!1,allowWAMP:!1},"broker")){r.next=2;break}throw this._cache.opStatus.error;case 2:if(o=this._isPlainObject(n),n&&!o)throw s=new k.InvalidParamError("advancedOptions"),this._fillOpStatusByError(s),s;r.next=7;break;case 7:if(i={},s=function(r,e){if(n[r])if(Array.isArray(n[r])&&n[r].length)i[r]=n[r];else{if(A(n[r])!==e)return!1;i[r]=[n[r]]}return!0},!o||s("exclude","number")&&s("exclude_authid","string")&&s("exclude_authrole","string")&&s("eligible","number")&&s("eligible_authid","string")&&s("eligible_authrole","string")){r.next=13;break}throw a=new k.InvalidParamError("advancedOptions"),this._fillOpStatusByError(a),a;case 13:if(c=(a=n||{}).ppt_scheme,u=a.ppt_serializer,l=a.ppt_cipher,h=a.ppt_keyid,p=a.exclude_me,f=a.disclose_me,c&&!this._checkPPTOptions("broker",n))throw this._cache.opStatus.error;r.next=16;break;case 16:if(i=W(W(W(W(W(W(W(W({acknowledge:!0},i),c?{ppt_scheme:c}:{}),c?{ppt_scheme:c}:{}),u?{ppt_serializer:u}:{}),l?{ppt_cipher:l}:{}),h?{ppt_keyid:h}:{}),p?{exclude_me:p}:{}),f?{disclose_me:f}:{}),d=t?this._packPPTPayload(t,i):{},_=d.err,d=d.payloadItems,E=this._getReqId(),_)throw this._cache.opStatus.error;r.next=21;break;case 21:return this._requests[E]={topic:e,callbacks:(0,C.getNewPromise)()},this._cache.opStatus=W(W({},O.SUCCESS),{},{reqId:E}),this._send([O.WAMP_MSG_SPEC.PUBLISH,E,i,e].concat(I(d||[]))),r.abrupt("return",this._requests[E].callbacks.promise);case 25:case"end":return r.stop()}},r,this)})),function(r,e,t){return a.apply(this,arguments)})},{key:"call",value:(s=L(T().mark(function r(e,t,n){var o,i,s,a,c,u,l,h,p,f,_,d,E,y;return T().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(this._preReqChecks({topic:e,patternBased:!1,allowWAMP:!0},"dealer")){r.next=2;break}throw this._cache.opStatus.error;case 2:if(n&&!this._isPlainObject(n))throw o=new k.InvalidParamError("advancedOptions"),this._fillOpStatusByError(o),o;r.next=6;break;case 6:if(i=(a=n||{}).timeout,s=a.progress_callback,a=a.disclose_me,d=s&&"function"!=typeof s,(c=i&&"number"!=typeof i)||d)throw d=c?"timeout":"progress_callback",o=new k.InvalidParamError(d),this._fillOpStatusByError(o),o;r.next=14;break;case 14:if(u=(c=n||{}).ppt_scheme,l=c.ppt_serializer,h=c.ppt_cipher,p=c.ppt_keyid,u&&!this._checkPPTOptions("dealer",n))throw this._cache.opStatus.error;r.next=17;break;case 17:for(;(f=this._getReqId())in this._calls;);if(_=W(W(W(W(W(W(W({},s?{receive_progress:!0}:{}),a?{disclose_me:!0}:{}),i?{timeout:i}:{}),u?{ppt_scheme:u}:{}),l?{ppt_serializer:l}:{}),h?{ppt_cipher:h}:{}),p?{ppt_keyid:p}:{}),d=t?this._packPPTPayload(t,_):{},E=d.err,y=d.payloadItems,E)throw this._cache.opStatus.error;r.next=22;break;case 22:return this._send([O.WAMP_MSG_SPEC.CALL,f,_,e].concat(I(y||[]))),this._cache.opStatus=W(W({},O.SUCCESS),{},{reqId:f}),this._calls[f]=(0,C.getNewPromise)(),s&&(this._calls[f].onProgress=s),r.abrupt("return",this._calls[f].promise);case 27:case"end":return r.stop()}},r,this)})),function(r,e,t){return s.apply(this,arguments)})},{key:"cancel",value:function(r,e){if(!this._preReqChecks(null,"dealer")||!this._checkRouterFeature("dealer","call_canceling"))throw this._cache.opStatus.error;var t,n;if(!r||!this._calls[r])throw n=new k.NonExistRPCReqIdError,this._fillOpStatusByError(n),n;if(!this._isPlainObject(e)&&void 0!==e)throw n=new k.InvalidParamError("advancedOptions"),this._fillOpStatusByError(n),n;if(this._isPlainObject(e)&&Object.hasOwnProperty.call(e,"mode")){if(!["skip","kill","killnowait"].includes(e.mode))throw n=new k.InvalidParamError("mode"),this._fillOpStatusByError(n),n;t=e.mode}return this._send([O.WAMP_MSG_SPEC.CANCEL,r,{mode:t}]),this._cache.opStatus=W(W({},O.SUCCESS),{},{reqId:r}),!0}},{key:"register",value:(i=L(T().mark(function r(e,t,n){var o,i,s,a,c,u,l;return T().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(null!=(o=this._rpcRegs[e])&&null!=(o=o.callbacks)&&o.length)throw o=new k.RPCAlreadyRegisteredError,this._fillOpStatusByError(o),o;r.next=4;break;case 4:if("function"!=typeof t)throw o=new k.NoCallbackError,this._fillOpStatusByError(o),o;r.next=8;break;case 8:if(n&&!this._isPlainObject(n))throw i=new k.InvalidParamError("advancedOptions"),this._fillOpStatusByError(i),i;r.next=12;break;case 12:if(s=(a=n||{}).match,a=a.invoke,c=s&&!["prefix","wildcard"].includes(s),u=a&&!["single","roundrobin","random","first","last"].includes(a),c||u)throw u=c?"match":"invoke",i=new k.InvalidParamError(u),this._fillOpStatusByError(i),i;r.next=20;break;case 20:if(this._preReqChecks({topic:e,patternBased:Boolean(s),allowWAMP:!1},"dealer")){r.next=22;break}throw this._cache.opStatus.error;case 22:return c=this._getReqId(),u=(0,C.getNewPromise)(),l=W(W({},s?{match:s}:{}),a?{invoke:a}:{}),t&&(u.rpc=t),this._requests[c]={topic:e,callbacks:u},this._send([O.WAMP_MSG_SPEC.REGISTER,c,l,e]),this._cache.opStatus=W(W({},O.SUCCESS),{},{reqId:c}),r.abrupt("return",u.promise);case 30:case"end":return r.stop()}},r,this)})),function(r,e,t){return i.apply(this,arguments)})},{key:"unregister",value:(o=L(T().mark(function r(e){var t,n;return T().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(this._preReqChecks({topic:e,patternBased:!1,allowWAMP:!1},"dealer")){r.next=2;break}throw this._cache.opStatus.error;case 2:if(this._rpcRegs[e]){r.next=6;break}throw t=new k.NonExistRPCUnregistrationError,this._fillOpStatusByError(t),t;case 6:return t=this._getReqId(),n=(0,C.getNewPromise)(),this._requests[t]={topic:e,callbacks:n},this._send([O.WAMP_MSG_SPEC.UNREGISTER,t,this._rpcRegs[e].id]),this._cache.opStatus=W(W({},O.SUCCESS),{},{reqId:t}),r.abrupt("return",n.promise);case 12:case"end":return r.stop()}},r,this)})),function(r){return o.apply(this,arguments)})}])&&j(r.prototype,e),n&&j(r,n),Object.defineProperty(r,"prototype",{writable:!1}),t}(),r=t.Wampy=r;t.default=r},{"./constants.js":3,"./errors.js":4,"./serializers/JsonSerializer.js":5,"./utils.js":6}]},{},[2]);
//# sourceMappingURL=wampy.min.js.map